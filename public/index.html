<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stripe API ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒ“ã‚¹</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      color: #333;
    }
    header {
      margin-bottom: 30px;
      border-bottom: 1px solid #eee;
      padding-bottom: 20px;
    }
    h1 {
      color: #6772e5;
      margin-bottom: 10px;
    }
    .subheading {
      color: #666;
      font-weight: normal;
      margin-top: 0;
    }
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 30px;
      margin: 40px 0;
    }
    .feature-card {
      border: 1px solid #e6e6e6;
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      flex-direction: column;
    }
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
    }
    .feature-icon {
      background-color: #f7fafc;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      font-size: 30px;
    }
    .feature-title {
      color: #6772e5;
      margin: 0 0 15px 0;
      font-size: 24px;
    }
    .feature-description {
      color: #666;
      margin-bottom: 20px;
      flex-grow: 1;
    }
    .btn {
      display: inline-block;
      background-color: #6772e5;
      color: white;
      padding: 12px 25px;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s ease;
      text-align: center;
    }
    .btn:hover {
      background-color: #5469d4;
    }
    .env-status {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin: 40px 0;
    }
    .env-status h2 {
      margin-top: 0;
    }
    .status-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 10px;
    }
    .status-pending {
      background-color: #ffc107;
    }
    .status-success {
      background-color: #28a745;
    }
    .status-error {
      background-color: #dc3545;
    }
    .note-section {
      margin-top: 50px;
      padding: 20px;
      background-color: #e9f7fe;
      border-left: 5px solid #6772e5;
      border-radius: 4px;
    }
    footer {
      margin-top: 50px;
      text-align: center;
      color: #666;
      font-size: 14px;
      border-top: 1px solid #eee;
      padding-top: 20px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Stripe API ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒ“ã‚¹</h1>
    <h2 class="subheading">Stripe API æ©Ÿèƒ½æ¤œè¨¼ç”¨ãƒ¢ãƒ‡ãƒ«ã‚µãƒ¼ãƒ“ã‚¹</h2>
  </header>

  <div class="features">
    <div class="feature-card">
      <div class="feature-icon">ğŸ’¼</div>
      <h3 class="feature-title">Connect è²©å£²è€…ç®¡ç†</h3>
      <div class="feature-description">
        <p>Stripe Connect ã‚’ä½¿ç”¨ã—ã¦è²©å£²è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã€ãƒãƒ«ãƒãƒ™ãƒ³ãƒ€ãƒ¼ã®ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚</p>
        <ul>
          <li>Express ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</li>
          <li>ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ•ãƒ­ãƒ¼</li>
          <li>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçŠ¶æ…‹ã®ç¢ºèª</li>
          <li>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹</li>
        </ul>
      </div>
      <a href="/connect/" class="btn">Connect æ©Ÿèƒ½ã‚’è©¦ã™</a>
    </div>

    <div class="feature-card">
      <div class="feature-icon">ğŸ›’</div>
      <h3 class="feature-title">å•†å“è³¼å…¥ (Checkout)</h3>
      <div class="feature-description">
        <p>Stripe Checkout ã‚’ä½¿ç”¨ã—ã¦å•†å“ã‚’è³¼å…¥ã—ã€è²©å£²è€…ã¨ã®åç›Šåˆ†é…ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚</p>
        <ul>
          <li>ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ</li>
          <li>ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆ</li>
          <li>è²©å£²è€…ã¸ã®åç›Šåˆ†é…</li>
          <li>ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</li>
        </ul>
      </div>
      <a href="/products/" class="btn">å•†å“è³¼å…¥æ©Ÿèƒ½ã‚’è©¦ã™</a>
    </div>

    <div class="feature-card">
      <div class="feature-icon">ğŸ”„</div>
      <h3 class="feature-title">ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³</h3>
      <div class="feature-description">
        <p>Stripe Billing ã‚’ä½¿ç”¨ã—ã¦å®šæœŸèª²é‡‘ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚</p>
        <ul>
          <li>é¡§å®¢ä½œæˆ</li>
          <li>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é–‹å§‹</li>
          <li>é¡§å®¢ãƒãƒ¼ã‚¿ãƒ«</li>
          <li>è«‹æ±‚æ›¸ã¨æ”¯æ‰•ã„</li>
        </ul>
      </div>
      <a href="/subscription/" class="btn">ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’è©¦ã™</a>
    </div>
  </div>

  <div class="env-status">
    <h2>ç’°å¢ƒè¨­å®šçŠ¶æ…‹</h2>
    <p>ãƒ†ã‚¹ãƒˆå‰ã«ä»¥ä¸‹ã®ç’°å¢ƒè¨­å®šãŒå¿…è¦ã§ã™ã€‚Wrangler secretã‚³ãƒãƒ³ãƒ‰ã¾ãŸã¯.dev.varsãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚</p>
    
    <div class="status-item">
      <span class="status-indicator status-pending" id="stripeKeyStatus"></span>
      <span>STRIPE_SECRET_KEY - Stripe APIã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼</span>
    </div>
    <div class="status-item">
      <span class="status-indicator status-pending" id="webhookStatus"></span>
      <span>STRIPE_WEBHOOK_SECRET - Webhookã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ</span>
    </div>
    <div class="status-item">
      <span class="status-indicator status-pending" id="connectStatus"></span>
      <span>STRIPE_CONNECT_CLIENT_ID - Connect ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID</span>
    </div>
    
    <button id="checkEnvBtn" class="btn" style="margin-top: 15px;">ç’°å¢ƒè¨­å®šã‚’ç¢ºèª</button>
  </div>

  <div class="note-section">
    <h3>ä½¿ç”¨ä¸Šã®æ³¨æ„</h3>
    <ul>
      <li>ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ãƒ†ã‚¹ãƒˆç”¨ã§ã™ã€‚Stripeã®ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</li>
      <li>ãƒ†ã‚¹ãƒˆã§ã¯<strong>å®Ÿéš›ã®æ”¯æ‰•ã„ã¯ç™ºç”Ÿã—ã¾ã›ã‚“</strong>ã€‚ãƒ†ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ã€Œ4242 4242 4242 4242ã€ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</li>
      <li>Webhookã®ãƒ†ã‚¹ãƒˆã«ã¯ã€ngrokãªã©ã®ãƒˆãƒ³ãƒãƒªãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ãŒå¿…è¦ã§ã™ã€‚</li>
      <li>è©³ç´°ãªæ‰‹é †ã«ã¤ã„ã¦ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã®ã€Œtest-procedure.mdã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</li>
    </ul>
  </div>

  <footer>
    <p>Â© 2025 Stripe API ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒ“ã‚¹ - v0.1.0</p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const checkEnvBtn = document.getElementById('checkEnvBtn');
      const stripeKeyStatus = document.getElementById('stripeKeyStatus');
      const webhookStatus = document.getElementById('webhookStatus');
      const connectStatus = document.getElementById('connectStatus');
      
      // ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã®ã©ã¡ã‚‰ã§ã‚‚å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãƒ™ãƒ¼ã‚¹URLã‚’æ¤œå‡º
      const getBaseUrl = () => {
        return window.location.origin;
      };
      
      // ç’°å¢ƒå¤‰æ•°ç¢ºèªãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
      checkEnvBtn.addEventListener('click', async () => {
        try {
          const baseUrl = getBaseUrl();
          // APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å‘¼ã³å‡ºã—ã¦ç’°å¢ƒå¤‰æ•°ã®è¨­å®šçŠ¶æ…‹ã‚’ç¢ºèª
          const response = await fetch(`${baseUrl}/api/environment-check`);
          
          if (response.ok) {
            const data = await response.json();
            
            if (data.success) {
              // APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’åŸºã«çŠ¶æ…‹è¡¨ç¤ºã‚’æ›´æ–°
              updateStatus(stripeKeyStatus, data.stripeSecretKey);
              updateStatus(webhookStatus, data.webhookSecret);
              updateStatus(connectStatus, data.connectClientId);
              
              if (data.stripeSecretKey && data.webhookSecret && data.connectClientId) {
                alert('âœ… ã™ã¹ã¦ã®ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†ã§ã™ï¼');
              } else {
                alert('âš ï¸ ä¸€éƒ¨ã®ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€wrangler secretã‚³ãƒãƒ³ãƒ‰ã¾ãŸã¯.dev.varsãƒ•ã‚¡ã‚¤ãƒ«ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚');
              }
            } else {
              alert(`âš ï¸ ç’°å¢ƒå¤‰æ•°ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${data.error}`);
            }
          } else {
            // APIãŒåˆ©ç”¨ã§ããªã„å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®çŠ¶æ…‹ã‚’è¡¨ç¤º
            console.log('ç’°å¢ƒç¢ºèªAPIãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚æ‰‹å‹•ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
            alert('ç’°å¢ƒç¢ºèªAPIãŒåˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚.dev.varsãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯wrangler secretã‚³ãƒãƒ³ãƒ‰ã§ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚');
          }
        } catch (error) {
          console.error('ç’°å¢ƒç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
          alert('ç’°å¢ƒç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
        }
      });
      
      // çŠ¶æ…‹è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
      function updateStatus(element, isSet) {
        if (isSet) {
          element.className = 'status-indicator status-success';
        } else {
          element.className = 'status-indicator status-error';
        }
      }
    });
  </script>
</body>
</html>